#WEB APPLICATION VULNERABILITY SCANNER

import requests
from bs4 import BeautifulSoup

# Sample URLs to test 
urls_to_scan = [
    "http://testphp.vulnweb.com/artists.php?artist=1",  # vulnerable test site
]

# SQL Injection test payloads
sql_payloads = ["'", "' OR '1'='1", "\" OR \"1\"=\"1", "' OR 1=1 --"]

# XSS test payload
xss_payload = "<script>alert('XSS')</script>"

def test_sql_injection(url):
    print(f"\nğŸ” Testing SQL Injection on: {url}")
    vulnerable = False
    for payload in sql_payloads:
        test_url = url + payload
        try:
            response = requests.get(test_url)
            if any(error in response.text.lower() for error in ["sql", "syntax", "mysql", "error", "warning"]):
                print(f"ğŸš¨ Possible SQL Injection Vulnerability Detected with payload: {payload}")
                vulnerable = True
        except Exception as e:
            print(f"âŒ Error accessing {test_url}: {e}")
    if not vulnerable:
        print("âœ… No SQL Injection detected.")

def test_xss(url):
    print(f"\nğŸ” Testing XSS on: {url}")
    test_url = url + xss_payload
    try:
        response = requests.get(test_url)
        soup = BeautifulSoup(response.text, "html.parser")
        if xss_payload in str(soup):
            print("ğŸš¨ Possible XSS Vulnerability Detected!")
        else:
            print("âœ… No XSS Vulnerability Detected.")
    except Exception as e:
        print(f"âŒ Error during XSS test: {e}")

# Start scanning
print("âš™ï¸ Starting Web Vulnerability Scan...")
for url in urls_to_scan:
    test_sql_injection(url)
    test_xss(url)

print("\nâœ… Scan Complete.")
